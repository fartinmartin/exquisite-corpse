(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{246:function(t,e,n){"use strict";n.r(e);n(49),n(17),n(18),n(10),n(37);var r=n(19),o=(n(16),n(2)),c=(n(148),n(110)),d=n(250),l=n(50);function h(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={name:"Canvas",components:{CanvasMeta:n(249).default},props:{id:{type:String,required:!0},mode:{type:String,required:!0},section:Object},data:function(){return{canvas:null,ctx:null}},mounted:function(){var canvas=this.$refs.canvas,t=canvas.getContext("2d");this.highDPI(canvas,t),this.canvas=canvas,this.ctx=t,t.fillStyle="#ffffff",t.fillRect(0,0,canvas.width,canvas.height),"draw"===this.mode?(this.$store.dispatch("modules/drawing/setCanvas",canvas),this.$store.dispatch("modules/drawing/setCtx",t)):"display"===this.mode?this.makeDrawing(this.drawing.paths,500):"pixelate"===this.mode&&(this.makeDrawing(this.drawing.paths),this.pixelateDrawing(this.canvas,this.ctx,75))},methods:{highDPI:function(canvas,t){var rect=canvas.getBoundingClientRect();canvas.width=rect.width*devicePixelRatio,canvas.height=rect.height*devicePixelRatio,t.scale(devicePixelRatio,devicePixelRatio),canvas.style.width=rect.width+"px",canvas.style.height=rect.height+"px"},mousedown:function(t){this.$store.dispatch("modules/mouse/setMousePosition",t),"fill"!==this.mouseMode?(this.$store.dispatch("modules/mouse/setIsDrawing",!0),this.handleDraw(t),this.$store.dispatch("modules/drawing/logPathToCurrentPath",t)):(this.handleDraw(t),this.$store.dispatch("modules/drawing/logPathToCurrentPath",t))},mousemove:function(t){this.isDrawing&&"fill"!==this.mouseMode&&(this.handleDraw(t),this.$store.dispatch("modules/drawing/logPathToCurrentPath",t),this.$store.dispatch("modules/mouse/setMousePosition",t))},mouseup:function(){this.$store.dispatch("modules/mouse/setIsDrawing",!1),this.$store.dispatch("modules/drawing/pushCurrentPathToDrawingHistory"),this.$store.dispatch("modules/drawing/incrementHistory")},mouseleave:function(){this.isDrawing&&(this.$store.dispatch("modules/mouse/setIsDrawing",!1),this.$store.dispatch("modules/drawing/pushCurrentPathToDrawingHistory"),this.$store.dispatch("modules/drawing/incrementHistory"))},handleDraw:function(t){var e,n=this.ctx;switch("draw"===this.mode?e={mode:this.mouseMode,color:this.palette.current,size:this.size.current,x1:this.x,y1:this.y,x2:t.offsetX,y2:t.offsetY}:"display"!==this.mode&&"pixelate"!==this.mode||(e=t),e.mode){case"draw":case"erase":this.drawPath(n,e);break;case"fill":this.drawFill(n,e);break;case"clear":this.clearCanvas(n)}},drawPath:function(t,e){t.lineCap="round",t.lineJoin="round",t.strokeStyle=e.color,t.lineWidth=2*e.size,"erase"===e.mode&&(t.globalCompositeOperation="destination-out"),t.beginPath(),t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.stroke(),t.closePath(),"erase"===e.mode&&(t.globalCompositeOperation="source-over")},drawFill:function(t,e){t.fillStyle=e.color;var n={x2:e.x2*devicePixelRatio,y2:e.y2*devicePixelRatio};c.a.fill(n.x2,n.y2,100,t)},clearCanvas:function(t){t.clearRect(0,0,t.canvas.width,t.canvas.height)},makeDrawing:function(t,e){var n=this;if(e){var r=function(){var n=Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(d.a)(t,function(){var n=Object(o.a)(regeneratorRuntime.mark((function n(path,i){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=i>0?e/t[i-1].length/100:e,n.next=3,Object(d.b)(r);case 3:return n.next=5,c(path,i);case 5:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}());case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),c=function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(path,i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.a)(path,function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(e,i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.b)(5);case 2:n.handleDraw(e);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();r()}else t.forEach((function(path,i){path.forEach((function(t){n.handleDraw(t)}))}))},pixelateDrawing:function(canvas,t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var o,img,c,d,l,h;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.filter="opacity(50%)",o=t.getImageData(0,0,t.canvas.width*devicePixelRatio,t.canvas.height*devicePixelRatio),r.next=4,createImageBitmap(o);case 4:return img=r.sent,c=img.width/e|0,d=img.height/e|0,t.imageSmoothingEnabled=t.mozImageSmoothingEnabled=t.msImageSmoothingEnabled=t.webkitImageSmoothingEnabled=!1,t.drawImage(img,0,0,c,d),l=t.getImageData(0,0,t.canvas.width,t.canvas.height),r.next=11,createImageBitmap(l);case 11:h=r.sent,n.clearCanvas(t),t.drawImage(h,0,0,c,d,0,0,h.width/devicePixelRatio,h.height/devicePixelRatio),n.$refs.notAllowed.bg();case 15:case"end":return r.stop()}}),r)})))()}},computed:f(f(f(f({},Object(l.c)("modules/mouse",["palette","size","x","y","isDrawing"])),Object(l.c)("modules/mouse",{mouseMode:function(t){return t.mode}})),Object(l.c)("modules/drawing",["sections"])),{},{drawing:function(){return"display"===this.mode?this.section:"pixelate"===this.mode?this.sections[this.id]:void 0}})},v=(n(256),n(7)),component=Object(v.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border",attrs:{id:t.id}},[n("div",{staticClass:"canvas-wrap"},["display"===t.mode?n("CanvasMeta",{staticClass:"drawing-meta",attrs:{title:t.section.title,artist:t.section.artist,docId:t.section.docId}}):t._e(),t._v(" "),"pixelate"===t.mode?n("CanvasMeta",{ref:"notAllowed",staticClass:"drawing-meta not-allowed",attrs:{title:t.drawing.title,artist:t.drawing.artist}}):t._e(),t._v(" "),n("canvas",t._g({ref:"canvas"},"draw"===t.mode?{mousemove:t.mousemove,mousedown:t.mousedown,mouseup:t.mouseup,mouseleave:t.mouseleave}:{}))],1)])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{CanvasMeta:n(249).default,Canvas:n(246).default})},247:function(t,e,n){var content=n(255);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(23).default)("7ffe6944",content,!0,{sourceMap:!1})},248:function(t,e,n){var content=n(257);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(23).default)("562a4561",content,!0,{sourceMap:!1})},249:function(t,e,n){"use strict";n.r(e);n(147);var r={props:{title:{type:String,required:!0},artist:{type:String,required:!0},docId:String},computed:{isInstagram:function(){return this.artist.startsWith("@")}},methods:{bg:function(){this.$refs.bg.style.backgroundColor="transparent"}}},o=(n(254),n(7)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"bg"},[n("div",{staticClass:"info"},[t.docId?n("nuxt-link",{attrs:{to:"/gallery/section/"+t.docId}},[t._v("\n      "+t._s(t.title)+"\n    ")]):t._e(),t._v(" "),t.docId?t._e():n("span",[t._v(t._s(t.title))]),t._v(" "),n("span",[t._v(" ")]),t._v(" "),n("span",[t._v("by")]),t._v(" "),n("span",[t._v(" ")]),t._v(" "),t.isInstagram?n("a",{attrs:{href:"https://www.instagram.com/"+t.artist.substr(1)+"/",target:"_blank",rel:"noopener noreferrer"}},[t._v("\n      "+t._s(t.artist)+"\n    ")]):n("span",[t._v(t._s(t.artist))])],1)])}),[],!1,null,"765a267d",null);e.default=component.exports},250:function(t,e,n){"use strict";n.d(e,"b",(function(){return c}));n(10),n(16);var r=n(2),o=function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<e.length)){t.next=7;break}return t.next=4,n(e[r],r,e);case 4:r++,t.next=1;break;case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),c=function(t){return new Promise((function(e){return setTimeout(e,t)}))};e.a=o},252:function(t,e,n){var r=n(5),o=n(253)(!1);r(r.S,"Object",{values:function(t){return o(t)}})},253:function(t,e,n){var r=n(8),o=n(38),c=n(31),d=n(58).f;t.exports=function(t){return function(e){for(var n,l=c(e),h=o(l),f=h.length,i=0,m=[];f>i;)n=h[i++],r&&!d.call(l,n)||m.push(t?[n,l[n]]:l[n]);return m}}},254:function(t,e,n){"use strict";var r=n(247);n.n(r).a},255:function(t,e,n){(e=n(22)(!1)).push([t.i,".drawing-meta[data-v-765a267d]{display:none;position:absolute;z-index:100;top:0;left:0;width:100%;height:100%;background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAFUlEQVQYlWNgoAb4N4HhP2UKhoUVAL3oD0/YmVPIAAAAAElFTkSuQmCC) repeat}.drawing-meta .info[data-v-765a267d]{position:absolute;display:flex;align-items:center;justify-content:center;z-index:101;top:50%;left:50%;transform:translate3d(-50%,-50%,0);background:var(--white);height:60px;min-width:33%;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;border:2px solid var(--orange);padding:0 1rem}a[data-v-765a267d]{text-decoration:underline}a[data-v-765a267d]:hover{color:var(--blue)}.drawing-meta.not-allowed[data-v-765a267d]{display:block;background-color:var(--white)}.drawing-meta.not-allowed .info[data-v-765a267d]{display:none}.drawing-meta.not-allowed:hover .info[data-v-765a267d]{display:flex}",""]),t.exports=e},256:function(t,e,n){"use strict";var r=n(248);n.n(r).a},257:function(t,e,n){(e=n(22)(!1)).push([t.i,"#mid,#top{border-bottom:none}#bot,#mid{border-top:none}.canvas-wrap{position:relative;overflow:hidden;width:100%;max-width:540px;height:0;padding-top:33.33333%}.canvas-wrap:hover .drawing-meta{display:block}canvas{position:absolute;top:0;left:0;width:100%;height:100%}",""]),t.exports=e},261:function(t,e,n){"use strict";n.r(e);var r=n(246),o={name:"Display",props:{sections:Object},components:{Canvas:r.default}},c=n(7),component=Object(c.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mw-canvas"},[e("Canvas",{attrs:{id:"top",mode:"display",section:this.sections.top}}),this._v(" "),e("Canvas",{attrs:{id:"mid",mode:"display",section:this.sections.mid}}),this._v(" "),e("Canvas",{attrs:{id:"bot",mode:"display",section:this.sections.bot}})],1)}),[],!1,null,"7ea7ad3c",null);e.default=component.exports;installComponents(component,{Canvas:n(246).default})},275:function(t,e,n){var content=n(312);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(23).default)("665a43f9",content,!0,{sourceMap:!1})},311:function(t,e,n){"use strict";var r=n(275);n.n(r).a},312:function(t,e,n){(e=n(22)(!1)).push([t.i,".loading[data-v-31e5afce],.title[data-v-31e5afce]{justify-content:center}.loading[data-v-31e5afce]{height:617.33333px;display:flex;align-items:center}",""]),t.exports=e},328:function(t,e,n){"use strict";n.r(e);n(49),n(17),n(37);var r=n(19),o=(n(18),n(10),n(252),n(16),n(2)),c=n(261);n(83),n(250);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function l(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var h={name:"index",components:{Display:c.default},data:function(){return{isFetching:"not yet",meta:null,sections:{}}},mounted:function(){this.fetchRandomCompleted()},methods:{fetchRandomCompleted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,c,d,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isFetching="yes",n=t.$fireStore.collection("completed"),r=n.doc().id,c=n.where(t.$fireStoreObj.FieldPath.documentId(),">=",r).limit(1),e.next=6,c.get();case 6:if(!((d=e.sent).size>0)){e.next=11;break}d.forEach((function(e){var n={docId:e.id,likes:e.data().likes,title:e.data().title,date:e.data().date},r=t;function c(){return(c=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getSections(e.data().sections);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){c.apply(this,arguments)}(),t.meta=n})),e.next=16;break;case 11:return l=n.where(t.$fireStoreObj.FieldPath.documentId(),"<",r).limit(1),e.next=14,l.get();case 14:e.sent.forEach((function(e){var n={docId:e.id,likes:e.data().likes,title:e.data().title,date:e.data().date},r=t;function c(){return(c=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getSections(e.data().sections);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){c.apply(this,arguments)}(),t.meta=n}));case 16:return e.abrupt("return");case 17:case"end":return e.stop()}}),e)})))()},getSections:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r,o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getSection(t.top);case 2:return r=n.sent,n.next=5,e.getSection(t.mid);case 5:return o=n.sent,n.next=8,e.getSection(t.bot);case 8:c=n.sent,e.sections.top=r,e.sections.mid=o,e.sections.bot=c,e.sections.top.paths=Object.values(r.drawing),e.sections.mid.paths=Object.values(o.drawing),e.sections.bot.paths=Object.values(c.drawing),e.isFetching="done";case 16:case"end":return n.stop()}}),n)})))()},getSection:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get();case 2:return n=e.sent,e.abrupt("return",l({docId:n.id},n.data()));case 4:case"end":return e.stop()}}),e)})))()},openHelp:function(){this.$store.dispatch("setIsHelping",!0)}}},f=(n(311),n(7)),component=Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap"},[n("nav",{staticClass:"border yellow info-panel mb mw-canvas"},[n("nuxt-link",{attrs:{to:"/"}},[n("h1",[t._v("exquisite corpse club")])]),t._v(" "),n("NavMenu")],1),t._v(" "),"done"!==t.isFetching?n("div",{staticClass:"loading mw-canvas"},[t._v("loading")]):t._e(),t._v(" "),"done"===t.isFetching?n("Display",{attrs:{sections:t.sections}}):t._e(),t._v(" "),"done"===t.isFetching?n("div",{staticClass:"border yellow info-panel mt mw-canvas title"},[n("nuxt-link",{attrs:{to:"/gallery/"+t.meta.docId}},[t._v(t._s(t.meta.title))])],1):t._e()],1)}),[],!1,null,"31e5afce",null);e.default=component.exports;installComponents(component,{NavMenu:n(83).default,Nav:n(71).default,Display:n(261).default})}}]);